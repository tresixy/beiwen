// 时代配置
export const ERAS = [
  {
    name: '生存时代',
    order: 1,
    description: '原始社会的石器时代晚期，部落以狩猎采集求生，知识靠口耳相传，发明聚焦取暖、食物与安全。',
    lore: [
      '生活形态：以部落为单位狩猎采集，没有文字，知识通过口耳相传延续。',
      '思考方式：极其具象，只能理解砸、烧、推、拉等直接的物理交互。',
      '科技重心：所有发明都围绕取暖、食物、安全等最基本的生存需求展开。',
    ],
  },
  {
    name: '城邦时代',
    order: 2,
    description: '农业革命后的青铜/铁器早期，人类定居建城，私有财产与社会分工兴起，并用象形文字或符号记录事务。',
    lore: [
      '社会结构：形成村落与早期城市，出现私有财产与多层的社会分工。',
      '经济活动：以物易物与初级货币并存，贸易逐渐成为连接城邦的纽带。',
      '思考方式：开始理解所有权、价值等抽象概念，建立初步的社会规则。',
    ],
  },
  {
    name: '分野时代',
    order: 3,
    description: '文明在近未来的富足时代面临方向抉择，生物技术、人工智能与太空探索齐头并进，促使人类重新定义存在意义。',
    lore: [
      '科技前沿：生物技术、人工智能与太空工程成为时代最尖端的研究领域。',
      '社会命题：在物质与信息几近无缺的背景下，人类重新审视文明的终极目的。',
      '分歧路径：宏观路线指向宇宙拓展，微观路线致力于意识与心灵的深层探索。',
    ],
  },
  {
    name: '帝国时代',
    order: 4,
    description: '古典时期的中央集权帝国，通过官僚体系统治辽阔疆域，大型工程与民族认同推动秩序与扩张。',
    lore: [
      '治理模式：强大的中央集权结合官僚体系来维持广袤疆域的秩序。',
      '工程能力：道路、长城等宏大工程成为连接与巩固帝国的象征。',
      '思考方式：强调秩序、效率、征服与集体叙事，以史诗与官方记录书写历史。',
    ],
  },
  {
    name: '理性时代',
    order: 5,
    description: '帝国晚期至中世纪中期，文明将目光投向哲学、逻辑、数学与天文学，知识集中于学者阶层，机械装置精巧但尚未形成统一科学方法。',
    lore: [
      '学术氛围：哲学、逻辑学、数学与天文学成为时代的核心学科。',
      '知识体系：学者、僧侣等精英在学院与修道院中收藏与传承智慧。',
      '技术特色：齿轮、杠杆等复杂机械被发明，但整体缺乏统一的科学方法论。',
    ],
  },
  {
    name: '信仰时代',
    order: 6,
    description: '中世纪的宗教神学主导时代，教会掌握世界解释权，艺术与建筑皆为神圣服务，思维趋向象征化与形而上。',
    lore: [
      '权力格局：教权与君权并立甚至高于君权，掌控社会运转。',
      '思维方式：高度象征化与形而上学，一切意义指向神圣与经卷。',
      '文化形态：艺术、建筑、音乐均围绕崇拜与仪式展开。',
    ],
  },
  {
    name: '启蒙时代',
    order: 7,
    description: '文艺复兴至第一次工业革命前，人文精神与科学方法重塑世界观，人权、民主与自由思想传播，探索自然力从敬畏走向驾驭。',
    lore: [
      '思想运动：人本主义与理性挑战宗教和君权的绝对权威。',
      '科学方法：实验、验证与逻辑推理成为认识世界的核心工具。',
      '技术探索：电力等自然力量被系统研究并尝试为人类所用。',
    ],
  },
  {
    name: '全球时代',
    order: 8,
    description: '工业革命至信息时代早期，蒸汽机与内燃机重塑生产力，全球化通过贸易、战争与殖民展开，信息传播首次快于交通工具。',
    lore: [
      '基础设施：蒸汽机、铁路与内燃机构建起全球范围的交通网络。',
      '世界格局：贸易、战争与殖民把各民族国家紧密绑定在同一体系内。',
      '信息革命：电报、电话与早期计算机让信息传播速度超越物流速度。',
    ],
  },
  {
    name: '第二次分野时代',
    order: 9,
    description: '文明跨越全球时代后面临终极分岔，必须在外向的星辰时代与内向的奇点时代之间作出抉择。',
    lore: [
      '立足点：物质与信息挑战已被解决，文明转向存在主义的终极思考。',
      '关键科技：太空电梯象征宏观扩张，脑机接口代表意识超越。',
      '决策后果：不同选择将分别引领文明走向星辰时代或奇点时代。',
    ],
  },
  {
    name: '星辰时代',
    order: 10,
    description: '远未来的太空文明，人类成为跨行星物种，思维尺度拓展到星系与光年，物理学边界成为新的桎梏。',
    lore: [
      '文明形态：跨行星社会在多行星乃至星际之间拓殖与治理。',
      '科学挑战：相对论与时空结构的限制成为新的技术瓶颈。',
      '核心议题：星际航行、地外殖民与宇宙尺度的资源调度。',
    ],
  },
  {
    name: '奇点时代',
    order: 11,
    description: '终极未来中，人工智能超越人类，生物与数字界限模糊，意识、记忆与身份被数据化，文明关注存在本身的定义。',
    lore: [
      '智能形态：人工智能与人类意识融合共存，智能层级全面跃迁。',
      '生命载体：生物肉体与虚拟空间界限消融，意识可被复制与传输。',
      '哲学命题：文明的核心议题转向“存在”与自我身份的重新定义。',
    ],
  },
];

// 获取时代顺序
export function getEraOrder(eraName) {
  const era = ERAS.find(e => e.name === eraName);
  return era ? era.order : 0;
}

// 检查时代是否已解锁
export function canAccessEra(currentEra, targetEra) {
  return getEraOrder(currentEra) >= getEraOrder(targetEra);
}

// 科技层级定义（根据时代限制可合成的物品）
export const TECH_TIERS = {
  '生存时代': {
    maxTier: 2,
    allowedConcepts: ['火', '工具', '食物', '庇护所', '简单工具', '采集', '狩猎'],
    forbiddenConcepts: ['电力', '机器', '核能', '火药', '钢铁', '引擎', '科技', '机械', '金属冶炼'],
  },
  '城邦时代': {
    maxTier: 4,
    allowedConcepts: ['建筑', '农业', '律法', '文字', '货币', '贸易', '防御', '石器', '陶器', '青铜'],
    forbiddenConcepts: ['电力', '机器', '核能', '火药', '引擎', '科技', '机械', '工业'],
  },
  '分野时代': {
    maxTier: 5,
    allowedConcepts: ['官僚', '宗教', '组织', '体系', '铁器', '战术'],
    forbiddenConcepts: ['电力', '机器', '核能', '引擎', '工业', '现代科技'],
  },
  '帝国时代': {
    maxTier: 6,
    allowedConcepts: ['道路', '史诗', '远洋', '帝国', '军事', '建筑工程', '钢铁', '火药'],
    forbiddenConcepts: ['电力', '机器', '核能', '引擎', '工业革命', '现代科技'],
  },
  '理性时代': {
    maxTier: 7,
    allowedConcepts: ['印刷', '启蒙', '蒸汽', '机械', '工业', '科学'],
    forbiddenConcepts: ['电力', '核能', '电子', '计算机', '太空'],
  },
  '信仰时代': {
    maxTier: 7,
    allowedConcepts: ['圣典', '艺术', '教权', '神学', '哲学'],
    forbiddenConcepts: ['核能', '电子', '计算机', '太空'],
  },
  '启蒙时代': {
    maxTier: 10,
    allowedConcepts: ['科学方法', '人权', '电力', '现代科技', '化学', '生物学', '物理学'],
    forbiddenConcepts: ['核能', '太空旅行', '量子计算'],
  },
  '全球时代': {
    maxTier: 12,
    allowedConcepts: ['计算机', '航空', '核能', '卫星', '互联网', '全球化', '可持续发展'],
    forbiddenConcepts: ['量子计算', '太空电梯', '曲率引擎', '脑机接口'],
  },
  '第二次分野时代': {
    maxTier: 15,
    allowedConcepts: ['太空电梯', '脑机接口', '人工智能', '基因工程', '核聚变'],
    forbiddenConcepts: ['曲率引擎', '意识上传', '冯·诺依曼探针'],
  },
  '星辰时代': {
    maxTier: 20,
    allowedConcepts: ['太空工业', '曲率引擎', '冯·诺依曼探针', '行星改造', '反物质'],
    forbiddenConcepts: ['意识上传', '数字永生', '集体意识'],
  },
  '奇点时代': {
    maxTier: 20,
    allowedConcepts: ['脑机接口', '意识上传', '数字永生', '集体意识', '虚拟现实'],
    forbiddenConcepts: ['曲率引擎', '太空殖民', '星际航行'],
  },
};

// 检查物品是否被时代限制
export function isTechAllowed(itemName, itemTier, itemAttrs, currentEra) {
  const config = TECH_TIERS[currentEra];
  if (!config) return true;

  // 检查tier限制
  if (itemTier > config.maxTier) {
    return { allowed: false, reason: `当前时代(${currentEra})的科技水平无法制造如此高级的物品` };
  }

  // 检查禁止的概念
  const itemText = itemName.toLowerCase() + ' ' + JSON.stringify(itemAttrs).toLowerCase();
  for (const forbidden of config.forbiddenConcepts) {
    if (itemText.includes(forbidden.toLowerCase())) {
      return { allowed: false, reason: `"${forbidden}"在${currentEra}还未出现` };
    }
  }

  return { allowed: true };
}

